//
// Generated by JSON2Apex http://json2apex.herokuapp.com/
//

/**
 * Data model of the transaction object from Darujme.cz
 */
public class DarujmeTransaction {

	public Integer transactionId;
	public String presentableCode;
	public TransactionState state;
	public Amount sentAmount;
	public String receivedAt;
	public Amount outgoingAmount;
	public String outgoingVs;
	public String outgoingBankAccount;
	public Pledge pledge;

	public enum TransactionState {
		PENDING,
		PENDING_CONFIRMATION,
		PENDING_UPDATE,
		SUCCESS,
		SUCCESS_MONEY_ON_ACCOUNT,
		SENT_TO_ORGANIZATION,
		FAILURE,
		ERROR,
		REFUND,
		TIMEOUT,
		CANCELED
	}

	public class Address {
		public String street;
		public String city;
		public String postCode;
		public String country;
	}

	public class Donor {
		public String firstName;
		public String lastName;
		public String email;
		public Address address;
		public String phone;
	}

	public class Pledge {
		public Integer pledgeId;
		public Integer organizationId;
		public Integer projectId;
		public Integer promotionId;
		public String paymentMethod;
		public Boolean isRecurrent;
		public Amount pledgedAmount;
		public String pledgedAt;
		public Donor donor;
		public Boolean wantDonationCertificate;
	}

	public class Amount {
		public Integer cents;
		public CurrencyType usedCurrency;
	}

	public enum CurrencyType {
		CZK,
		EUR,
		GBP,
		USD
	}


	public Contact createContact() {
		return new ContactHandler()
		.setEmail(this.pledge.donor.email)
		.setFirstName(this.pledge.donor.firstName)
		.setLastName(this.pledge.donor.lastName)
		.setPhone(this.pledge.donor.phone)
		.setCity(this.pledge.donor.address.city)
		.setStreet(this.pledge.donor.address.street)
		.setPostCode(this.pledge.donor.address.postCode)
		.setDescription('Imported from Darujme.cz')
		.build();
	}

	public Account createAccount() {
		return new AccountHandler()
		.setName(this.pledge.donor.firstName + ' ' + this.pledge.donor.lastName)
		.setDescription('Imported from Darujme.cz')
		.build();
	}

	public Dar__c createDar() {
		return new DarHandler()
		.setName(this.receivedAt.left(10))
		.setDatum(Date.valueOf(this.receivedAt.left(10)))
		.setDarovanaCastka(this.sentAmount.cents / 100)
		.setPrijataCastka(this.outgoingAmount.cents / 100)
		.setPozadujePotvrzeni(this.pledge.wantDonationCertificate)
		.setDarovanoNaVyzvu(this.pledge.promotionId != null)
		.setPravidelnyDar(this.pledge.isRecurrent)
		.setTransactionId(this.transactionId)
		.setZdroj('DARUJME')
		.setCampaignId(this.pledge.projectId)
		.setDonorEmail(this.pledge.donor.email)
		.build();
	}
}
